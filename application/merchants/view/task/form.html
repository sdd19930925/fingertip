{extend name='admin@public/content'}

{block name="content"}
<form action="{:request()->url()}" autocomplete="off" class='form-horizontal layui-form padding-top-20' data-auto="true"
      id="ProductForm"
      method="post" onsubmit="return false;">
    <!--{if !empty($store)}-->
    <div class="form-group">
        <label class="col-sm-2 control-label">平台</label>
        <div class='col-sm-8 text-top'>
            <select class="layui-select full-width" name="platform" required>
                {foreach $platform as $k=>$v}
                <!--{if isset($vo.platform) and $v['id'] eq $vo.platform}-->
                <option selected value="{$v.id}">{$v.cate_title}</option>
                <!--{else}-->
                <option value="{$v.id}">{$v.cate_title}</option>
                <!--{/if}-->
                {/foreach}
            </select>
        </div>
    </div>
    <!--{/if}-->
    <!--{if !empty($cate)}-->
    <div class="form-group">
        <label class="col-sm-2 control-label">分类</label>
        <div class='col-sm-8 text-top'>
            <select class="layui-select full-width" name="task_cate" required>
                {foreach $cate as $k=>$v}
                <!--{if isset($vo.task_cate) and $v['id'] eq $vo.task_cate}-->
                <option selected value="{$v.id}">{$v.cate_title}</option>
                <!--{else}-->
                <option value="{$v.id}">{$v.cate_title}</option>
                <!--{/if}-->
                {/foreach}
            </select>
        </div>
    </div>
    <!--{/if}-->
    <!--{if !empty($store)}-->
    <div class="form-group">
        <label class="col-sm-2 control-label">店铺</label>
        <div class='col-sm-8 text-top'>
            <select class="layui-select full-width" name="store_id" required>
                {foreach $store as $k=>$v}
                <!--{if isset($vo.store_id) and $v['id'] eq $vo.store_id}-->
                <option selected value="{$v.id}">{$v.store_num}</option>
                <!--{else}-->
                <option value="{$v.id}">{$v.store_num}</option>
                <!--{/if}-->
                {/foreach}
            </select>
        </div>
    </div>
    <!--{/if}-->
    <div class="form-group">
        <label class="col-sm-2 control-label label-required">类型</label>

        <div class='col-sm-8'>
            <label class="think-radio">
                {empty name="vo.ty"}
                <input checked lay-ignore name="ty" title="浏览任务" type="radio" value="1">浏览任务
                <input lay-ignore name="ty" title="垫付任务" type="radio" value="2">垫付任务
                {else /}
                <input lay-ignore name="ty" name="vo.ty" title="浏览任务" type="radio" value="1" {eq}checked{/eq}>浏览任务
                <input lay-ignore name="ty" name="vo.ty" title="垫付任务" type="radio" value="2" {eq}checked{/eq}>垫付任务{/empty}
            </label>

        </div>
    </div>
    <div class="hr-line-dashed"></div>
    <!--{/if}-->
    <div class="form-group">
        <label class="col-sm-2 control-label">商品</label>
        <div class='col-sm-8'>
            <input class="layui-input" name="goods_name" placeholder="请输入标题" required title="请输入商品"
                   value="{$vo.goods_name|default=''}">
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-2 control-label">商品链接</label>
        <div class='col-sm-8'>
            <input class="layui-input" name="goods_url" placeholder="请输入链接" required title="请输入链接"
                   value="{$vo.goods_url|default=''}">
        </div>
    </div>

    <div class="form-group">
        <label class="col-sm-2 control-label label-required">商品主图</label>
        <div class='col-sm-8'>
            <table class="layui-table background-item margin-none" lay-size="sm" lay-skin="nob">
                <thead>
                <tr>
                    <td>商品主图</td>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td class="text-top" style="width:100px">
                        <input name="goods_pic" type="hidden" value="{$vo.goods_pic|default=''}">
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-2 control-label">商品价格</label>
        <div class='col-sm-8'>
            <input class="layui-input" name="goods_price" placeholder="请输入产品价格" required title="请输入产品价格"
                   value="{$vo.goods_price|default=''}">
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-2 control-label">展示价格</label>
        <div class='col-sm-8'>
            <input class="layui-input" name="mobile_price" placeholder="请输入展示价格" required title="请输入展示价格"
                   value="{$vo.mobile_price|default=''}">
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-2 control-label">购买数量</label>
        <div class='col-sm-8'>
            <input class="layui-input" name="goods_num" placeholder="请输入购买数量" required title="请输入购买数量"
                   value="{$vo.goods_num|default=''}">
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-2 control-label">产品关键词</label>
        <div class='col-sm-8'>
            <input class="layui-input" name="goods_key" placeholder="请输入产品关键词" required title="请输入产品关键词"
                   value="{$vo.goods_key|default=''}">
        </div>
    </div>
    <div class="hr-line-dashed"></div>
    <div class="form-group">
        <label class="col-sm-2 control-label">放单数量</label>
        <div class='col-sm-8'>
            <input class="layui-input" name="amount" placeholder="请输入放单数量" required title="请输入放单数量"
                   value="{$vo.amount|default=''}">
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-2 control-label">发布时间</label>
        <div class="col-sm-8">
            <input class="layui-input" id="tim" name="tim" placeholder="请选择发布时间" value="{$vo.tim|default=''}">
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-2 control-label">任务奖励</label>
        <div class='col-sm-8'>
            <input class="layui-input" name="price" placeholder="请输入任务奖励" required title="请输入任务奖励"
                   value="{$vo.price|default=''}">
        </div>
    </div>
    <div class="form-group">
        <label class="col-sm-2 control-label label-required">补充介绍</label>
        <div class='col-sm-8'>
            <textarea name="content">{$vo.content|default=''|raw}</textarea>
        </div>
    </div>
    <div class="hr-line-dashed"></div>

    <div class="col-sm-7 col-sm-offset-2">
        <div class="layui-form-item text-center">
            {if !empty($vo.id)}<input name="id" type="hidden" value="{$vo.id}">
            {else /}
            <input name="uid" type="hidden" value="{$uid|default=''}">
            {/if}
            <button class="layui-btn" type="submit">保存配置</button>
            <button class="layui-btn layui-btn-danger" onclick="window.history.back()" type='button'>取消编辑</button>
        </div>
    </div>

</form>

<script>
    require(['jquery', 'ckeditor', 'angular'], function () {
        window.form.render();
        window.createEditor('[name="content"]', {height: 500});
        window.laydate.render({range: false, elem: '#tim', type: 'datetime'});
        var app = angular.module("ProductForm", []).run(callback);
        angular.bootstrap(document.getElementById(app.name), [app.name]);

        function callback($rootScope) {
            // 绑定规格列表
            $rootScope.specs = [];
            // 规格默认数据
            var specdata = JSON.parse('{$vo.list|default=[]|json_encode=###,256|raw}');
            // 单图片上传处理
            $('#ProductForm [name="goods_pic"]').uploadOneImage();
            // 多图片上传处理

        }
    });
</script>
{/block}

{block name="style"}
<style>

    .background-item {
        padding: 15px;
        background: #efefef;
    }

    .background-item thead tr {
        background: #e0e0e0
    }

    .price-input-td {
        padding: 0 !important;
    }

    .price-input-td:before {
        margin: 4px;
        width: 35px;
        height: 22px;
        content: "金额";
        line-height: 20px;
        text-align: center;
        position: absolute;
        background: #e2e2e2;
    }

    .price-input-td input {
        height: 30px;
        padding-left: 50px;
        border: none !important;
    }
</style>
{/block}